# Code Signing Certificates

These are notes and tutorial followed to create the code signing certificate.

## Windows
** DISCLAIMER: this has been generated by ChatGPT3.5. Some information might be imprecise or incorrect. 

To create a self-signed certificate for code-signing purposes using PowerShell's New-SelfSignedCertificate cmdlet, you can follow these steps:

#### Step 1: Open PowerShell as Administrator
Open PowerShell with administrator privileges because creating certificates typically requires administrative access.

#### Step 2: Run the Command
Use the New-SelfSignedCertificate cmdlet to generate the certificate. Here's an example command:

TEMPLATE: 
```powershell
New-SelfSignedCertificate -Type CodeSigningCert -Subject "CN=YourCompanyName" -KeyUsage DigitalSignature -CertStoreLocation "Cert:\CurrentUser\My" -FriendlyName "YourCodeSigningCertName"
```

ACTUAL COMMAND:
```powershell
New-SelfSignedCertificate -Type CodeSigningCert -Subject "CN=Xureilab" -KeyUsage DigitalSignature -CertStoreLocation "Cert:\CurrentUser\My" -FriendlyName "ShadertasticCert"
```

Explanation of Parameters:
- **Type CodeSigningCert**: Specifies the type of certificate to create, in this case, a code signing certificate.
- **Subject "CN=YourCompanyName"**: Defines the subject name for the certificate. Replace "YourCompanyName" 
  with your actual company name or any name you prefer.
- **KeyUsage DigitalSignature**: Specifies that the key can be used for digital signatures.
- **CertStoreLocation "Cert:\CurrentUser\My"**: Sets the location to store the certificate. 
  This example stores it in the Current User's personal certificate store.
- **FriendlyName "YourCodeSigningCertName"**: Assigns a friendly name to the certificate for easier identification.
  Replace "YourCodeSigningCertName" with your desired name.

#### Step 3: Export the Certificate (Optional)
You might want to export the certificate for use on other machines or to share it.
Use the following command to export it to a .pfx file:

```powershell
Export-PfxCertificate -Cert "Cert:\CurrentUser\My\[CertificateThumbprint]" -FilePath "C:\path\to\exported\certificate.pfx" -Password (ConvertTo-SecureString -String "YourPassword" -Force -AsPlainText)
```

Replace "CertificateThumbprint" with the actual thumbprint of your certificate 
(you can get this from the output of the New-SelfSignedCertificate command).  
Also, replace "YourPassword" with your desired password for the exported .pfx file. 
**DO NOT** reuse a password from anywhere else. Use a password manager, don't be stupid.

#### Step 4 : Encode the pfx with certutil
(This has not been generated by ChatGPT)
```powershell
certutil -encode certificate.pfx certificate.txt
```

#### Step 5 : Add the encoded certificate in the Github actions secret
In the repository settings > secrets and variables > Actions.  

Add a repository secret named `WINDOWS_CERTIFICATE` with the content of `certificate.txt`.  
Add anothe repository secret named `WINDOWS_CERTIFICATE_PASS` with the password you used to generate it.

#### Step 6 : Remove files and Clear History !!! üîí
You needed to write your password in the command line, you probably want to remove it from the history:
```powershell
Clear-History
Remove-Item (Get-PSReadlineOption).HistorySavePath
```
‚ö†Ô∏è This will clear your whole CLI history. I personnaly don't care, as I'm using a spare computer just for that. 
But you might want something else if you want to keep your history.

Also, you should probably delete the certificate.txt and certificate.pfx files, and store them in a more secure place.
For example, a password manager.

#### Important Notes:
Remember to keep your private key secure and avoid sharing it.  
Self-signed certificates might not be as trusted as those issued by a certificate authority (CA), especially in production environments.   
Users might receive warnings when using software signed with a self-signed certificate.  
This process generates a self-signed code signing certificate that you can use to sign DLLs or other software components.
